其实，区块链网络作为一种分布式的系统，对于共有链来说，所有节点维护相同的账本，共识就是要保证分布式下的数据一致性。

## 一、共有链共识

### 1.POW 工作量证明机制

就是比特币采用的共识方法，就是俗称挖矿。它是这样做的，就是一笔交易被创建之后，会向全网广播，矿工会收集这些交易放到自己交易池里面，交易达到一定的数据之后，就用这些交易去构造一个区块，它的构造方法就是：对区块头做双重hash运算。

一个区块造好了之后，它的头的数据是确定的，基本上就是有版本、还有上一个区块的hash，时间戳，目标难度值，随机值。挖矿就是算这个区块头看里的一个随机值，加上这个hash值之后，让hash结果小于当前网络的目标难度。一旦找到了，就算是竞争到记账权了。

#### 1.1 POW设计的巧妙之处

为了能让大家愿意记账，也就是扩大区块链网络，交易的发起方需要交一定的手续费，让矿工打包的时候获得，每次生成区块的时候，获得区块记账权的节点会有奖励。

但是呢，为了不让整个网络扩张的太快，挖矿难度是会动态调整，保持在10min出一个。你看这个效率，也就是最少10min你才能知道转账成功了，这在日常生活中买卖的场景是很难被接受的。

### 2.POS 权益证明机制

它是因为PoW太浪费资源提出的替代性方案，延续了PoW中的竞争出块的方法，它的改进是说，因为pow中所有的挖矿节点他们算随机数是基于整个网络的目标难度，没有谁搞特殊，pos的话它可以理解为给网络里的有钱人开了特权，持有的币的数据越多时间越长，他的目标难度值就越小，他的目标难度x币龄x币的数量，这样的话，允许他算出来的随机数范围更大。

#### 2.1 POS设计的好坏

因为pos，越有钱的节点越有可能获得记账权，所以他一旦出一个块，他持有的币龄（钱*时间）都会清空，防止恶意攻击。虽然它降低了算力，但是动态的挖矿难度影响出块的稳定程度，鼓励了用户囤积代币。

### 3.DPoS 股份授权证明机制

这种方式里面，不让所有节点都去竞争出块，它是让网络里持有货币的参与者投票选区块生产者，DPOS会选择投票数靠前“101”个生产者来进行下101个区块的生成工作，节点的前后关系由系统随机安排。在生成过程中，若被发现失信行为，该生产者会被踢出，由第102个票数持有者加入区块生成。

